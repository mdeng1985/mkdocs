<!doctype html><html lang=zh class=no-js> <head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content="Mdeng li"><link href=https://mdeng1985.github.io/mkdocs/2-%E5%85%B7%E4%BD%93%E9%A1%B9%E7%9B%AE%E5%AE%9E%E8%B7%B5/%E7%BC%96%E7%A8%8B/cmake%26vs%E5%B7%A5%E5%85%B7%E7%AF%87/cygwin/ rel=canonical><link rel=icon href=../../../../assets/favicon.png><meta name=generator content="mkdocs-1.1.2, mkdocs-material-7.1.1"><title>Cygwin - Mdeng Li's Blog</title><link rel=stylesheet href=../../../../assets/stylesheets/main.9299cb39.min.css><link rel=stylesheet href=../../../../assets/stylesheets/palette.ef6f36e2.min.css><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback"><style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style><script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","None","auto"),ga("set","anonymizeIp",!0),ga("send","pageview"),document.addEventListener("DOMContentLoaded",function(){document.forms.search&&document.forms.search.query.addEventListener("blur",function(){var e;this.value&&(e=document.location.pathname,ga("send","pageview",e+"?q="+this.value))}),"undefined"!=typeof location$&&location$.subscribe(function(e){ga("send","pageview",e.pathname)})})</script><script async src=https://www.google-analytics.com/analytics.js></script></head> <body dir=ltr data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo> <script>function __prefix(e){return new URL("../../../..",location).pathname+"."+e}function __get(e,t=localStorage){return JSON.parse(t.getItem(__prefix(e)))}</script> <script>var palette=__get("__palette");if(null!==palette&&"object"==typeof palette.color)for(var key in palette.color)document.body.setAttribute("data-md-color-"+key,palette.color[key])</script> <input class=md-toggle data-md-toggle=drawer type=checkbox id=__drawer autocomplete=off> <input class=md-toggle data-md-toggle=search type=checkbox id=__search autocomplete=off> <label class=md-overlay for=__drawer></label> <div data-md-component=skip> <a href=#cygwin class=md-skip> 跳转至 </a> </div> <div data-md-component=announce> </div> <header class=md-header data-md-component=header> <nav class="md-header__inner md-grid" aria-label=Header> <a href=../../../.. title="Mdeng Li's Blog" class="md-header__button md-logo" aria-label="Mdeng Li's Blog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> <label class="md-header__button md-icon" for=__drawer> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg> </label> <div class=md-header__title data-md-component=header-title> <div class=md-header__ellipsis> <div class=md-header__topic> <span class=md-ellipsis> Mdeng Li's Blog </span> </div> <div class=md-header__topic data-md-component=header-topic> <span class=md-ellipsis> Cygwin </span> </div> </div> </div> <form class=md-header__option data-md-component=palette> <input class=md-option data-md-color-media data-md-color-scheme=default data-md-color-primary=indigo data-md-color-accent=indigo type=radio name=__palette id=__palette_1> <label class="md-header__button md-icon" title="Switch to dark mode" for=__palette_2 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M7 10a2 2 0 0 1 2 2 2 2 0 0 1-2 2 2 2 0 0 1-2-2 2 2 0 0 1 2-2m10-3a5 5 0 0 1 5 5 5 5 0 0 1-5 5H7a5 5 0 0 1-5-5 5 5 0 0 1 5-5h10M7 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3h10a3 3 0 0 0 3-3 3 3 0 0 0-3-3H7z"/></svg> </label> <input class=md-option data-md-color-media data-md-color-scheme=slate data-md-color-primary=red data-md-color-accent=red type=radio name=__palette id=__palette_2> <label class="md-header__button md-icon" title="Switch to light mode" for=__palette_1 hidden> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M17 7H7a5 5 0 0 0-5 5 5 5 0 0 0 5 5h10a5 5 0 0 0 5-5 5 5 0 0 0-5-5m0 8a3 3 0 0 1-3-3 3 3 0 0 1 3-3 3 3 0 0 1 3 3 3 3 0 0 1-3 3z"/></svg> </label> </form> <label class="md-header__button md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> </label> <div class=md-search data-md-component=search role=dialog> <label class=md-search__overlay for=__search></label> <div class=md-search__inner role=search> <form class=md-search__form name=search> <input type=text class=md-search__input name=query aria-label=搜索 placeholder=搜索 autocapitalize=off autocorrect=off autocomplete=off spellcheck=false data-md-component=search-query data-md-state=active required> <label class="md-search__icon md-icon" for=__search> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg> </label> <button type=reset class="md-search__icon md-icon" aria-label=Clear tabindex=-1> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg> </button> </form> <div class=md-search__output> <div class=md-search__scrollwrap data-md-scrollfix> <div class=md-search-result data-md-component=search-result> <div class=md-search-result__meta> 正在初始化搜索引擎 </div> <ol class=md-search-result__list></ol> </div> </div> </div> </div> </div> <div class=md-header__source> <a href=https://github.com/squidfunk/mkdocs title="前往 GitHub 仓库" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> mkdocs </div> </a> </div> </nav> </header> <div class=md-container data-md-component=container> <nav class=md-tabs aria-label=Tabs data-md-component=tabs> <div class="md-tabs__inner md-grid"> <ul class=md-tabs__list> <li class=md-tabs__item> <a href=../../../../mkdocs_src/ class=md-tabs__link> 首页 </a> </li> <li class=md-tabs__item> <a href=../../../../mkdocs_src/getting-started/ class=md-tabs__link> 兴趣 </a> </li> <li class=md-tabs__item> <a href=../../../../mkdocs_src/setup/changing-the-colors/ class=md-tabs__link> 工作 </a> </li> <li class=md-tabs__item> <a href=../../../../mkdocs_src/reference/abbreviations/ class=md-tabs__link> 办公 </a> </li> <li class=md-tabs__item> <a href=../../../../mkdocs_src/insiders/ class=md-tabs__link> Insiders </a> </li> </ul> </div> </nav> <main class=md-main data-md-component=main> <div class="md-main__inner md-grid"> <div class="md-sidebar md-sidebar--primary" data-md-component=sidebar data-md-type=navigation> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--primary md-nav--lifted" aria-label=Navigation data-md-level=0> <label class=md-nav__title for=__drawer> <a href=../../../.. title="Mdeng Li's Blog" class="md-nav__button md-logo" aria-label="Mdeng Li's Blog" data-md-component=logo> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 89 89"> <path d=M3.136,17.387l0,42.932l42.932,21.467l-42.932,-64.399Z /> <path d=M21.91,8l42.933,64.398l-18.775,9.388l-42.932,-64.399l18.774,-9.387Z style="fill-opacity: 0.5"/> <path d=M67.535,17.387l-27.262,18.156l21.878,32.818l5.384,2.691l0,-53.665Z /> <path d=M67.535,17.387l0,53.666l18.774,-9.388l0,-53.665l-18.774,9.387Z style="fill-opacity: 0.25"/> </svg> </a> Mdeng Li's Blog </label> <div class=md-nav__source> <a href=https://github.com/squidfunk/mkdocs title="前往 GitHub 仓库" class=md-source data-md-component=source> <div class="md-source__icon md-icon"> <svg xmlns=http://www.w3.org/2000/svg viewbox="0 0 448 512"><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg> </div> <div class=md-source__repository> mkdocs </div> </a> </div> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../mkdocs_src/ class=md-nav__link> 首页 </a> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_2 type=checkbox id=__nav_2> <label class=md-nav__link for=__nav_2> 兴趣 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=兴趣 data-md-level=1> <label class=md-nav__title for=__nav_2> <span class="md-nav__icon md-icon"></span> 兴趣 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../mkdocs_src/getting-started/ class=md-nav__link> Installation </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_3 type=checkbox id=__nav_3> <label class=md-nav__link for=__nav_3> 工作 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=工作 data-md-level=1> <label class=md-nav__title for=__nav_3> <span class="md-nav__icon md-icon"></span> 工作 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../mkdocs_src/setup/changing-the-colors/ class=md-nav__link> Changing the colors </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_4 type=checkbox id=__nav_4> <label class=md-nav__link for=__nav_4> 办公 <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=办公 data-md-level=1> <label class=md-nav__title for=__nav_4> <span class="md-nav__icon md-icon"></span> 办公 </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../mkdocs_src/reference/abbreviations/ class=md-nav__link> Abbreviations </a> </li> <li class=md-nav__item> <a href=../../../../mkdocs_src/mkdocs%E8%AF%AD%E6%B3%95/ class=md-nav__link> mkdocs </a> </li> </ul> </nav> </li> <li class="md-nav__item md-nav__item--nested"> <input class="md-nav__toggle md-toggle" data-md-toggle=__nav_5 type=checkbox id=__nav_5> <label class=md-nav__link for=__nav_5> Insiders <span class="md-nav__icon md-icon"></span> </label> <nav class=md-nav aria-label=Insiders data-md-level=1> <label class=md-nav__title for=__nav_5> <span class="md-nav__icon md-icon"></span> Insiders </label> <ul class=md-nav__list data-md-scrollfix> <li class=md-nav__item> <a href=../../../../mkdocs_src/insiders/ class=md-nav__link> Sponsorship </a> </li> </ul> </nav> </li> </ul> </nav> </div> </div> </div> <div class="md-sidebar md-sidebar--secondary" data-md-component=sidebar data-md-type=toc> <div class=md-sidebar__scrollwrap> <div class=md-sidebar__inner> <nav class="md-nav md-nav--secondary" aria-label=目录> <label class=md-nav__title for=__toc> <span class="md-nav__icon md-icon"></span> 目录 </label> <ul class=md-nav__list data-md-component=toc data-md-scrollfix> <li class=md-nav__item> <a href=#_1 class=md-nav__link> 安装设置相关 </a> <nav class=md-nav aria-label=安装设置相关> <ul class=md-nav__list> <li class=md-nav__item> <a href=#cygwing class=md-nav__link> 安装cygwin及和g++ </a> </li> <li class=md-nav__item> <a href=#_2 class=md-nav__link> 设置技巧 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_3 class=md-nav__link> 编译一般性说明 </a> </li> <li class=md-nav__item> <a href=#cygwin_1 class=md-nav__link> cygwin的一些工具 </a> </li> <li class=md-nav__item> <a href=#linux class=md-nav__link> 常用的linux命令 </a> </li> <li class=md-nav__item> <a href=#g class=md-nav__link> g++实践 </a> <nav class=md-nav aria-label=g++实践> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_4 class=md-nav__link> 运行一个简单的程序 </a> </li> <li class=md-nav__item> <a href=#include-path class=md-nav__link> include path </a> </li> <li class=md-nav__item> <a href=#_5 class=md-nav__link> 生成库 </a> <nav class=md-nav aria-label=生成库> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_6 class=md-nav__link> 生成静态库 </a> </li> <li class=md-nav__item> <a href=#_7 class=md-nav__link> 生成动态库 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_8 class=md-nav__link> 调用库 </a> <nav class=md-nav aria-label=调用库> <ul class=md-nav__list> <li class=md-nav__item> <a href=#_9 class=md-nav__link> 查看不指明库名出现的错误 </a> </li> <li class=md-nav__item> <a href=#_10 class=md-nav__link> 调用静态库 </a> </li> <li class=md-nav__item> <a href=#_11 class=md-nav__link> 动态库的调用 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#g_1 class=md-nav__link> g++ 命令总结 </a> </li> </ul> </nav> </li> <li class=md-nav__item> <a href=#_12 class=md-nav__link> 参考资料 </a> </li> </ul> </nav> </div> </div> </div> <div class=md-content data-md-component=content> <article class="md-content__inner md-typeset"> <h1 id=cygwin>Cygwin<a class=headerlink href=#cygwin title="Permanent link">&para;</a></h1> <h2 id=_1>安装设置相关<a class=headerlink href=#_1 title="Permanent link">&para;</a></h2> <h3 id=cygwing>安装cygwin及和g++<a class=headerlink href=#cygwing title="Permanent link">&para;</a></h3> <p>安装cygwin,我选择devel所有，把所有的开发工具都安装了。</p> <p>cygwin中g++版本的区别</p> <p><div class=highlight><pre><span></span><code>    cygwin32-gcc-g++ is a compiler for 32 bit cygwin
    gcc-g++ is the basic 64 bit compiler (you probably must install this one).
    mingw-gcc-g++ is a 32 bit compiler for native 32 bit Windows
    mingw64-x86_64-gcc-g++ is a 64 bit compiler for native 64 bit Windows
    mingw64-i686-gcc-g++ is a 64 bit compiler for native 32 bit Windows
</code></pre></div> 安装完以后，运行<code>cygcheck -c</code> 检查下，然后再<code>g++ --version</code>查看下版本。</p> <p>see: <a href=https://www3.ntu.edu.sg/home/ehchua/programming/cpp/gcc_make.html>GCC and Make Compiling, Linking and Building C/C++ Application</a></p> <p>安装版本 2.877 64位</p> <p>g++ -maix64</p> <h3 id=_2>设置技巧<a class=headerlink href=#_2 title="Permanent link">&para;</a></h3> <p>see: <a href=http://arachnoid.com/cpptutor/setup_windows.html>Setting up to compile C++ on Windows</a></p> <p>先安装cygwin，然后新建一个<code>gccp.bat</code>，如下 <div class=highlight><pre><span></span><code>        @echo off
        echo compiling C++ using -ansi -pedantic-errors -Wall
        g++ -ansi -pedantic-errors -Wall %1 %2 %3
</code></pre></div></p> <p>编译的时候<code>gccp temp.cpp</code> （使用<code>gcc+</code>也可以，但是使用那个bat文件更规范化）</p> <h2 id=_3>编译一般性说明<a class=headerlink href=#_3 title="Permanent link">&para;</a></h2> <ul> <li> <p>头文件</p> <ul> <li>头文件一般为<code>.h</code>，在编译c++文件时候用到</li> <li>主要作用：以后深入学习</li> <li>编译器在编译源文件的时候需要用到头文件</li> <li>编译器在include-path里寻找头文件，编译的时候通过<code>-Idir</code>指出（或者环境变量CPATH）</li> </ul> </li> <li> <p>库文件</p> <ul> <li>连接器需要将库文件夹和编译以后文件变成可执行文件</li> <li>库文件在<code>-Ldir</code>中指出(或者环境变量<code>LIBRARY_PATH</code>)</li> </ul> </li> <li> <p>连接器不仅需要知道路径，还需要知道库的名字。</p> <ul> <li>静态库：<code>.a</code>（unix） 或者<code>.lib</code>（window）</li> <li>动态库: <code>.so</code> (unix) 或者 <code>.dll</code> （window）</li> </ul> </li> <li> <p>环境变量</p> <div class=highlight><pre><span></span><code>- PATH: For searching the executables and run-time shared libraries (.dll, .so).

- CPATH: For searching the include-paths for headers. It is searched after paths specified in -I&lt;dir&gt; options. C_INCLUDE_PATH and CPLUS_INCLUDE_PATH can be used to specify C and C++ headers if the particular language was indicated in pre-processing.

- LIBRARY_PATH: For searching library-paths for link libraries. It is searched after paths specified in -L&lt;dir&gt; options.
</code></pre></div> </li> </ul> <p>可以通过系统echo来显示环境变量, 比如<code>echo $HOME</code>显示HOME环境变量。</p> <h2 id=cygwin_1>cygwin的一些工具<a class=headerlink href=#cygwin_1 title="Permanent link">&para;</a></h2> <ul> <li> <p>cygcheck：比如缺少了某库，导致程序无法运行，则可以使用此工具，去检测到底问题出在哪里。</p> </li> <li> <p>cygpath：实现Linux/Unix和Windows之间的路径转换。 </p> </li> </ul> <h2 id=linux>常用的linux命令<a class=headerlink href=#linux title="Permanent link">&para;</a></h2> <ul> <li>pwd 显示当前路径</li> <li>env 显示所有环境变量，<code>echo $HOME</code>显示HOME环境变量</li> <li>ls 列出当前目录下的文件</li> <li>rmdir 删除目录</li> <li>rm 栓除文件</li> <li>mv 文件改名或者目录改名</li> <li>man 联机帮助 e.g.<code>man ls</code></li> <li>less 显示文件最后几行</li> </ul> <h2 id=g>g++实践<a class=headerlink href=#g title="Permanent link">&para;</a></h2> <h4 id=_4>运行一个简单的程序<a class=headerlink href=#_4 title="Permanent link">&para;</a></h4> <p>假设源程序为<code>prog1.cpp</code>,首先利用cygpath 将windows的路径转换成linux路径，然后cd到该目录下</p> <div class=highlight><pre><span></span><code>    cygpath -au &#39;d:\mdeng\WORK\MyCode\CodePratices\workSpaceCppGcc\cpp_primer\chap1\&#39;

    cd /cygdrive/d/mdeng/WORK/MyCode/CodePratices/workSpaceCppGcc/cpp_primer/chap1/
</code></pre></div> <p>实际上直接加上单引号就可以了</p> <div class=highlight><pre><span></span><code>cd &#39;d:\mdeng\WORK\MyCode\CodePratices\workSpaceCppGcc\cpp_primer\chap1\&#39;
</code></pre></div> <p>然后编译</p> <div class=highlight><pre><span></span><code> g++ -o hello.exe prog1.cpp
   // Compile and link source hello.cpp into executable hello.exe
 hello
   // Execute under CMD shell
$ ./hello  
   // Execute under Bash or Bourne shell, specifying the current path (./) 在cygwin的命令窗口里输入这个
</code></pre></div> <p>如果输入</p> <p><div class=highlight><pre><span></span><code><span class=n>g</span><span class=o>++</span> <span class=o>-</span><span class=n>Wall</span> <span class=o>-</span><span class=n>g</span> <span class=o>-</span><span class=n>o</span> <span class=n>Hello</span><span class=p>.</span><span class=n>exe</span> <span class=n>prog1</span><span class=p>.</span><span class=n>cpp</span>
</code></pre></div> 会输出警告信息（Wall），以及额外的符号调试信息。</p> <p>如果将编译和连接分开进行：</p> <div class=highlight><pre><span></span><code>    <span class=c1>// Compile-only with -c option</span>
     <span class=n>g</span><span class=o>++</span> <span class=o>-</span><span class=n>c</span> <span class=o>-</span><span class=n>Wall</span> <span class=o>-</span><span class=n>g</span> <span class=n>prog1</span><span class=p>.</span><span class=n>cpp</span> <span class=c1>//生成了.o文件</span>
     <span class=c1>// Link object file(s) into an executable</span>
     <span class=n>g</span><span class=o>++</span> <span class=o>-</span><span class=n>g</span> <span class=o>-</span><span class=n>o</span> <span class=n>Hello</span><span class=p>.</span><span class=n>exe</span> <span class=n>prog1</span><span class=p>.</span><span class=n>o</span>
</code></pre></div> <p>如果要查看编译的详细信息，加上<code>-v</code></p> <div class=highlight><pre><span></span><code>g++ -v prog1.cpp -o hello.exe
</code></pre></div> <h3 id=include-path>include path<a class=headerlink href=#include-path title="Permanent link">&para;</a></h3> <p>假设有<code>Circle.h</code>和<code>Circle.cpp</code>，cpp文件调用了h头文件， 如果两者位于同一文件夹，且引用的方式为<code>#include "Circle.h"</code>，则编译的时候不需要指明include路径。否则需要指定包含路径，实现方式有如下几种：</p> <ol> <li> <p><code>-I</code>命令行指定法</p> </li> <li> <p>放在g++系统的include path里</p> </li> <li> <p>环境变量法</p> </li> </ol> <p><strong>方式1</strong></p> <div class=highlight><pre><span></span><code><span class=n>g</span><span class=o>++</span>  <span class=o>-</span><span class=n>I</span> <span class=err>&#39;</span><span class=nl>d</span><span class=p>:</span><span class=err>\</span><span class=n>mdeng</span><span class=err>\</span><span class=n>WORK</span><span class=err>\</span><span class=n>MyCode</span><span class=err>\</span><span class=n>CodePratices</span><span class=err>\</span><span class=n>workSpaceCppGcc</span><span class=err>\</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=err>\</span><span class=n>testIncludePatah</span><span class=err>\&#39;</span>  <span class=o>-</span><span class=n>c</span> <span class=n>Circle</span><span class=p>.</span><span class=n>cpp</span>
</code></pre></div> <p>**方式2：**首先看系统有哪些include path,<a href=http://stackoverflow.com/questions/11946294/dump-include-paths-from-g>参考</a></p> <p><div class=highlight><pre><span></span><code><span class=n>g</span><span class=o>++</span> <span class=o>-</span><span class=n>E</span> <span class=o>-</span><span class=n>x</span> <span class=n>c</span><span class=o>++</span> <span class=o>-</span> <span class=o>-</span><span class=n>v</span> <span class=o>&lt;</span> <span class=o>/</span><span class=n>dev</span><span class=o>/</span><span class=n>null</span>
</code></pre></div> 然后放到include path里，然后运行<code>g++ -c Circle.cpp</code>, 这种方式不推荐，仅测试用。</p> <p><strong>设置环境变量法</strong></p> <p><a href=https://gcc.gnu.org/onlinedocs/cpp/Environment-Variables.html>官方说明</a></p> <p><a href=http://www.network-theory.co.uk/docs/gccintro/gccintro_23.html>设置方法参考</a></p> <div class=highlight><pre><span></span><code>    <span class=n>CPLUS_INCLUDE_PATH</span><span class=o>=</span><span class=err>&#39;</span><span class=nl>d</span><span class=p>:</span><span class=err>\</span><span class=n>mdeng</span><span class=err>\</span><span class=n>WORK</span><span class=err>\</span><span class=n>MyCode</span><span class=err>\</span><span class=n>CodePratices</span><span class=err>\</span><span class=n>workSpaceCppGcc</span><span class=err>\</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=err>\</span><span class=n>testIncludePatah</span><span class=err>\&#39;</span>
    <span class=k>export</span> <span class=n>CPLUS_INCLUDE_PATH</span>
</code></pre></div> <p>然后运行<code>g++ -c Circle.cpp</code></p> <p><font color=#0009ff size=3 face=黑体>几点说明和注意</font></p> <ul> <li> <p><font color=#0009ff size=3 face=黑体>设置的等号后面不能有空格</font></p> </li> <li> <p><font color=#0009ff size=3 face=黑体>export那行命令不可缺少</font></p> </li> <li> <p><font color=#0009ff size=3 face=黑体>设置完以后可以运行<code>g++ -E -x c++ - -v &lt; /dev/null</code>检查下是否设置好</font></p> </li> <li> <p><font color=#0009ff size=3 face=黑体>设置完以后重启以后环境变量就没了，要想重启以后还有的话就需要将上面的两行命令放到<code>.bash_profile</code>文件里</font></p> </li> <li> <p><font color=#0009ff size=3 face=黑体>清除include path的话，使用<code>CPLUS_INCLUDE_PATH=''</code> ，要将多个目录添加为include路径应该是用冒号隔开(unix路径)，比如：</font></p> </li> </ul> <div class=highlight><pre><span></span><code><span class=n>LIBRARY_PATH</span><span class=o>=/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>gcc</span><span class=o>/</span><span class=n>x86_64</span><span class=o>-</span><span class=n>pc</span><span class=o>-</span><span class=n>cygwin</span><span class=o>/</span><span class=mf>5.4.0</span><span class=o>/:/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>gcc</span><span class=o>/</span><span class=n>x86_64</span><span class=o>-</span><span class=n>pc</span><span class=o>-</span><span class=n>cygwin</span><span class=o>/</span><span class=mf>5.4.0</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=n>x86_64</span><span class=o>-</span><span class=n>pc</span><span class=o>-</span><span class=n>cygwin</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=n>lib</span><span class=o>/:/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>gcc</span><span class=o>/</span><span class=n>x86_64</span><span class=o>-</span><span class=n>pc</span><span class=o>-</span><span class=n>cygwin</span><span class=o>/</span><span class=mf>5.4.0</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=n>lib</span><span class=o>/:/</span><span class=n>lib</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=n>lib</span><span class=o>/:/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=n>lib</span><span class=o>/:/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>gcc</span><span class=o>/</span><span class=n>x86_64</span><span class=o>-</span><span class=n>pc</span><span class=o>-</span><span class=n>cygwin</span><span class=o>/</span><span class=mf>5.4.0</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=n>x86_64</span><span class=o>-</span><span class=n>pc</span><span class=o>-</span><span class=n>cygwin</span><span class=o>/</span><span class=n>lib</span><span class=o>/:/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span><span class=n>gcc</span><span class=o>/</span><span class=n>x86_64</span><span class=o>-</span><span class=n>pc</span><span class=o>-</span><span class=n>cygwin</span><span class=o>/</span><span class=mf>5.4.0</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=p>..</span><span class=o>/</span><span class=p>..</span><span class=o>/:/</span><span class=n>lib</span><span class=o>/:/</span><span class=n>usr</span><span class=o>/</span><span class=n>lib</span><span class=o>/</span>
</code></pre></div> <ul> <li> <p><font color=#0009ff size=3 face=黑体> 搜索顺序：首先搜索<code>-I</code>指定路径，然后搜索<code>CPLUS_INCLUDE_PATH</code>环境变量的路径，最后搜索系统自带的路径：</font></p> </li> <li> <p><font color=#0009ff size=3 face=黑体> 一般如果是下载的封装好的库文件，可以修改<code>.bash_profile</code>进行永久性设置，但是如果在g++里再设置会覆盖<code>.bash_profile</code>的设置。</font></p> </li> </ul> <h3 id=_5>生成库<a class=headerlink href=#_5 title="Permanent link">&para;</a></h3> <h4 id=_6>生成静态库<a class=headerlink href=#_6 title="Permanent link">&para;</a></h4> <ol> <li>接上文，首先先将cpp编译成<code>.o</code>文件</li> </ol> <div class=highlight><pre><span></span><code> <span class=n>g</span><span class=o>++</span>  <span class=o>-</span><span class=n>I</span> <span class=err>&#39;</span><span class=nl>d</span><span class=p>:</span><span class=err>\</span><span class=n>mdeng</span><span class=err>\</span><span class=n>WORK</span><span class=err>\</span><span class=n>MyCode</span><span class=err>\</span><span class=n>CodePratices</span><span class=err>\</span><span class=n>workSpaceCppGcc</span><span class=err>\</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=err>\</span><span class=n>testIncludePatah</span><span class=err>\&#39;</span>  <span class=o>-</span><span class=n>c</span> <span class=n>Circle</span><span class=p>.</span><span class=n>cpp</span>
</code></pre></div> <ol> <li>然后利用<code>ar</code>工具打包成静态库</li> </ol> <p><div class=highlight><pre><span></span><code>ar -crv libCircle.a Circle.o
</code></pre></div> 这样就生成了静态库<code>.a</code>文件。人为的将其复制到别的目录测试。比如说：</p> <div class=highlight><pre><span></span><code><span class=nl>d</span><span class=p>:</span><span class=err>\</span><span class=n>mdeng</span><span class=err>\</span><span class=n>WORK</span><span class=err>\</span><span class=n>MyCode</span><span class=err>\</span><span class=n>CodePratices</span><span class=err>\</span><span class=n>workSpaceCppGcc</span><span class=err>\</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=err>\</span><span class=n>testLibPath</span>\
</code></pre></div> <p><a href=http://www.cnblogs.com/skynet/p/3372855.html>参考资料</a></p> <h4 id=_7>生成动态库<a class=headerlink href=#_7 title="Permanent link">&para;</a></h4> <p><div class=highlight><pre><span></span><code><span class=n>g</span><span class=o>++</span> <span class=o>-</span><span class=n>fPIC</span>   <span class=o>-</span><span class=n>c</span> <span class=n>Circle</span><span class=p>.</span><span class=n>cpp</span>  <span class=err>#生成</span><span class=p>.</span><span class=n>o文件</span>
<span class=n>g</span><span class=o>++</span> <span class=o>-</span><span class=n>shared</span> <span class=o>-</span><span class=n>o</span> <span class=n>libCircle</span><span class=p>.</span><span class=n>so</span> <span class=n>Circle</span><span class=p>.</span><span class=n>o</span>  <span class=err>#</span> <span class=err>打包成动态库</span><span class=p>.</span><span class=n>so</span>
</code></pre></div> <code>-fPIC</code> 创建与地址无关的编译程序（pic，position independent code），是为了能够在多个应用程序间共享。</p> <p><a href=http://www.cnblogs.com/skynet/p/3372855.html>参考资料</a></p> <h3 id=_8>调用库<a class=headerlink href=#_8 title="Permanent link">&para;</a></h3> <p>主程序为<code>TestCircle.cpp</code>为主程序调用库</p> <p><div class=highlight><pre><span></span><code>    <span class=cm>/* A test driver for the Circle class (TestCircle.cpp) */</span>
    <span class=cp>#include</span> <span class=cpf>&lt;iostream&gt;</span><span class=cp></span>
    <span class=cp>#include</span> <span class=cpf>&quot;Circle.h&quot;</span><span class=c1>   // using Circle class</span><span class=cp></span>
    <span class=k>using</span> <span class=k>namespace</span> <span class=n>std</span><span class=p>;</span>

    <span class=kt>int</span> <span class=nf>main</span><span class=p>()</span> <span class=p>{</span>
       <span class=c1>// Construct an instance of Circle c1</span>
       <span class=n>Circle</span> <span class=n>c1</span><span class=p>(</span><span class=mf>1.2</span><span class=p>,</span> <span class=s>&quot;red&quot;</span><span class=p>);</span>
       <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&quot;Radius=&quot;</span> <span class=o>&lt;&lt;</span> <span class=n>c1</span><span class=p>.</span><span class=n>getRadius</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&quot; Area=&quot;</span> <span class=o>&lt;&lt;</span> <span class=n>c1</span><span class=p>.</span><span class=n>getArea</span><span class=p>()</span>
            <span class=o>&lt;&lt;</span> <span class=s>&quot; Color=&quot;</span> <span class=o>&lt;&lt;</span> <span class=n>c1</span><span class=p>.</span><span class=n>getColor</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>

       <span class=n>c1</span><span class=p>.</span><span class=n>setRadius</span><span class=p>(</span><span class=mf>2.1</span><span class=p>);</span>   <span class=c1>// Change radius and color of c1</span>
       <span class=n>c1</span><span class=p>.</span><span class=n>setColor</span><span class=p>(</span><span class=s>&quot;blue&quot;</span><span class=p>);</span>
       <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&quot;Radius=&quot;</span> <span class=o>&lt;&lt;</span> <span class=n>c1</span><span class=p>.</span><span class=n>getRadius</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&quot; Area=&quot;</span> <span class=o>&lt;&lt;</span> <span class=n>c1</span><span class=p>.</span><span class=n>getArea</span><span class=p>()</span>
            <span class=o>&lt;&lt;</span> <span class=s>&quot; Color=&quot;</span> <span class=o>&lt;&lt;</span> <span class=n>c1</span><span class=p>.</span><span class=n>getColor</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>

       <span class=c1>// Construct another instance using the default constructor</span>
       <span class=n>Circle</span> <span class=n>c2</span><span class=p>;</span>
       <span class=n>cout</span> <span class=o>&lt;&lt;</span> <span class=s>&quot;Radius=&quot;</span> <span class=o>&lt;&lt;</span> <span class=n>c2</span><span class=p>.</span><span class=n>getRadius</span><span class=p>()</span> <span class=o>&lt;&lt;</span> <span class=s>&quot; Area=&quot;</span> <span class=o>&lt;&lt;</span> <span class=n>c2</span><span class=p>.</span><span class=n>getArea</span><span class=p>()</span>
            <span class=o>&lt;&lt;</span> <span class=s>&quot; Color=&quot;</span> <span class=o>&lt;&lt;</span> <span class=n>c2</span><span class=p>.</span><span class=n>getColor</span><span class=p>()</span>  <span class=o>&lt;&lt;</span> <span class=n>endl</span><span class=p>;</span>
       <span class=k>return</span> <span class=mi>0</span><span class=p>;</span>
    <span class=p>}</span>
</code></pre></div> 库分为静态库(<code>.a</code>或<code>lib</code>)和动态库（共享库，<code>.so</code>或<code>.dll</code>）。不管是调用那种库都有三种调用方式: </p> <ol> <li> <p><code>g++</code>命令后面直接给出库的路径和名称</p> </li> <li> <p><code>g++ -L后面接库路径，然后接库名</code></p> </li> <li> <p>将库所在路径添加到环境变量，假如库名为libCab.a，那么添加完环境变量以后，<code>g++ -lCab.....</code>。（这种方法仅适用于库名是以lib开头的情况）</p> </li> </ol> <p>首先生成4个库，1个静态库1个动态库，两个库都采用标准命名形式以lib开头。</p> <div class=highlight><pre><span></span><code><span class=n>CPLUS_INCLUDE_PATH</span><span class=o>=</span><span class=err>&#39;</span><span class=nl>d</span><span class=p>:</span><span class=err>\</span><span class=n>mdeng</span><span class=err>\</span><span class=n>WORK</span><span class=err>\</span><span class=n>MyCode</span><span class=err>\</span><span class=n>CodePratices</span><span class=err>\</span><span class=n>workSpaceCppGcc</span><span class=err>\</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=err>\</span><span class=n>testIncludePatah</span><span class=err>\&#39;</span>
    <span class=k>export</span> <span class=n>CPLUS_INCLUDE_PATH</span>
    <span class=n>g</span><span class=o>++</span> <span class=o>-</span><span class=n>c</span> <span class=n>Circle</span><span class=p>.</span><span class=n>cpp</span>
    <span class=n>ar</span> <span class=o>-</span><span class=n>crv</span> <span class=n>libCircle</span><span class=p>.</span><span class=n>a</span> <span class=n>Circle</span><span class=p>.</span><span class=n>o</span>
    <span class=n>g</span><span class=o>++</span> <span class=o>-</span><span class=n>shared</span> <span class=o>-</span><span class=n>o</span> <span class=n>libCircle</span><span class=p>.</span><span class=n>so</span> <span class=n>Circle</span><span class=p>.</span><span class=n>o</span>  <span class=err>#</span> <span class=err>打包成动态库</span><span class=p>.</span><span class=n>so</span>
</code></pre></div> <p>动态库放入<code>d:\mdeng\WORK\MyCode\CodePratices\workSpaceCppGcc\ehchua-cpp\testLibPath\dynamic\</code>;</p> <p>静态库放入<code>d:\mdeng\WORK\MyCode\CodePratices\workSpaceCppGcc\ehchua-cpp\testLibPath\static\</code></p> <h4 id=_9>查看不指明库名出现的错误<a class=headerlink href=#_9 title="Permanent link">&para;</a></h4> <p>首先不指明库文件进行编译</p> <p><div class=highlight><pre><span></span><code>g++  -I &#39;d:\mdeng\WORK\MyCode\CodePratices\workSpaceCppGcc\ehchua-cpp\testIncludePatah\&#39;  -o TestCircle.exe TestCircle.cpp
</code></pre></div> 会出错，<code>对‘Circle::Circle(double, std::string)’未定义的引用</code>，因此如果有类似的错误，可能说明系统没有找到库文件。</p> <h4 id=_10>调用静态库<a class=headerlink href=#_10 title="Permanent link">&para;</a></h4> <p>库文件不仅要指出路径还要指出库文件名，首先给出最直观的编译方式。下面两种写法都是正确的。第一种写法库文件的路径给出的是windows系统系统的路径，第二种写法库文件的路径是在linux中给出的。</p> <p>上文中已经定义了环境变量<code>CPLUS_INCLUDE_PATH</code>，这里不需要再指明include path。</p> <div class=highlight><pre><span></span><code><span class=cp># 路径格式为window路径</span>
<span class=n>g</span><span class=o>++</span>  <span class=n>TestCircle</span><span class=p>.</span><span class=n>cpp</span> <span class=err>&#39;</span><span class=nl>d</span><span class=p>:</span><span class=err>\</span><span class=n>mdeng</span><span class=err>\</span><span class=n>WORK</span><span class=err>\</span><span class=n>MyCode</span><span class=err>\</span><span class=n>CodePratices</span><span class=err>\</span><span class=n>workSpaceCppGcc</span><span class=err>\</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=err>\</span><span class=n>testLibPath</span><span class=err>\</span><span class=k>static</span><span class=err>\</span><span class=n>libCircle</span><span class=p>.</span><span class=n>a</span><span class=err>&#39;</span>  <span class=o>-</span><span class=n>o</span> <span class=n>TestCircle</span><span class=p>.</span><span class=n>exe</span> 
<span class=cp># 路径格式为linux路径</span>
<span class=n>g</span><span class=o>++</span>   <span class=n>TestCircle</span><span class=p>.</span><span class=n>cpp</span> <span class=o>/</span><span class=n>cygdrive</span><span class=o>/</span><span class=n>d</span><span class=o>/</span><span class=n>mdeng</span><span class=o>/</span><span class=n>WORK</span><span class=o>/</span><span class=n>MyCode</span><span class=o>/</span><span class=n>CodePratices</span><span class=o>/</span><span class=n>workSpaceCppGcc</span><span class=o>/</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=o>/</span><span class=n>testLibPath</span><span class=o>/</span><span class=k>static</span><span class=o>/</span><span class=n>libCircle</span><span class=p>.</span><span class=n>a</span> <span class=o>-</span><span class=n>o</span> <span class=n>TestCircle</span><span class=p>.</span><span class=n>exe</span> 
</code></pre></div> <p>具体说明如下：</p> <ol> <li> <p><code>TestCircle.cpp</code>源文件名</p> </li> <li> <p><code>'d:\mdeng\WORK\MyCode\CodePratices\workSpaceCppGcc\ehchua-cpp\testLibPath\libCircle.a'</code>库文件名和路径</p> </li> <li> <p><code>-o TestCircle.exe</code> 编译生成exe文件</p> </li> </ol> <p><strong>注意</strong> cpp文件不能放在库文件后面，比如下面的写法编译不通过</p> <div class=highlight><pre><span></span><code><span class=n>g</span><span class=o>++</span>  <span class=o>-</span><span class=n>I</span> <span class=err>&#39;</span><span class=nl>d</span><span class=p>:</span><span class=err>\</span><span class=n>mdeng</span><span class=err>\</span><span class=n>WORK</span><span class=err>\</span><span class=n>MyCode</span><span class=err>\</span><span class=n>CodePratices</span><span class=err>\</span><span class=n>workSpaceCppGcc</span><span class=err>\</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=err>\</span><span class=n>testIncludePatah</span><span class=err>\&#39;</span> <span class=o>-</span><span class=n>L</span> <span class=err>&#39;</span><span class=nl>d</span><span class=p>:</span><span class=err>\</span><span class=n>mdeng</span><span class=err>\</span><span class=n>WORK</span><span class=err>\</span><span class=n>MyCode</span><span class=err>\</span><span class=n>CodePratices</span><span class=err>\</span><span class=n>workSpaceCppGcc</span><span class=err>\</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=err>\</span><span class=n>testLibPath</span><span class=err>\</span><span class=n>Circle</span><span class=p>.</span><span class=n>a</span><span class=err>&#39;</span>  <span class=o>-</span><span class=n>o</span> <span class=n>TestCircle</span><span class=p>.</span><span class=n>exe</span> <span class=n>TestCircle</span><span class=p>.</span><span class=n>cpp</span>
</code></pre></div> <p><strong>设置环境变量调用静态库的过程</strong></p> <div class=highlight><pre><span></span><code><span class=n>LIBRARY_PATH</span><span class=o>=/</span><span class=n>cygdrive</span><span class=o>/</span><span class=n>d</span><span class=o>/</span><span class=n>mdeng</span><span class=o>/</span><span class=n>WORK</span><span class=o>/</span><span class=n>MyCode</span><span class=o>/</span><span class=n>CodePratices</span><span class=o>/</span><span class=n>workSpaceCppGcc</span><span class=o>/</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=o>/</span><span class=n>testLibPath</span><span class=o>/</span><span class=k>static</span> 
<span class=k>export</span> <span class=n>LIBRARY_PATH</span>
<span class=n>g</span><span class=o>++</span>  <span class=n>TestCircle</span><span class=p>.</span><span class=n>cpp</span> <span class=o>-</span><span class=n>lCircle</span> <span class=o>-</span><span class=n>o</span> <span class=n>TestCircle</span><span class=p>.</span><span class=n>exe</span> 
</code></pre></div> <p>说明如下</p> <ul> <li> <p><code>LIBRARY_PATH</code>为静态库路径的环境变量</p> </li> <li> <p><code>-lCircle</code> 中<code>-l</code>表示连接的意思，<code>Circle</code>表示连接的是<code>libCircl.a</code></p> </li> <li> <p><code>-lCircle</code> 中不能有后缀名，否则编译通不过</p> </li> </ul> <h4 id=_11>动态库的调用<a class=headerlink href=#_11 title="Permanent link">&para;</a></h4> <p>和静态库的调用类似，这里给出环境变量法调用方法：</p> <p><div class=highlight><pre><span></span><code><span class=n>g</span><span class=o>++</span>  <span class=n>TestCircle</span><span class=p>.</span><span class=n>cpp</span> <span class=err>&#39;</span><span class=nl>d</span><span class=p>:</span><span class=err>\</span><span class=n>mdeng</span><span class=err>\</span><span class=n>WORK</span><span class=err>\</span><span class=n>MyCode</span><span class=err>\</span><span class=n>CodePratices</span><span class=err>\</span><span class=n>workSpaceCppGcc</span><span class=err>\</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=err>\</span><span class=n>testLibPath</span><span class=err>\</span><span class=n>dynamic</span><span class=err>\</span><span class=n>libCircle</span><span class=p>.</span><span class=n>so</span><span class=err>&#39;</span>  <span class=o>-</span><span class=n>o</span> <span class=n>TestCircle</span><span class=p>.</span><span class=n>exe</span> 
</code></pre></div> 生成exe完以后需要把库拷贝到exe所在的文件夹才能运行。</p> <p>下面采用环境变量法 <div class=highlight><pre><span></span><code><span class=n>LD_LIBRARY_PATH</span><span class=o>=/</span><span class=n>cygdrive</span><span class=o>/</span><span class=n>d</span><span class=o>/</span><span class=n>mdeng</span><span class=o>/</span><span class=n>WORK</span><span class=o>/</span><span class=n>MyCode</span><span class=o>/</span><span class=n>CodePratices</span><span class=o>/</span><span class=n>workSpaceCppGcc</span><span class=o>/</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=o>/</span><span class=n>testLibPath</span><span class=o>/</span><span class=n>dynamic</span> 
<span class=k>export</span> <span class=n>LD_LIBRARY_PATH</span>
<span class=n>g</span><span class=o>++</span>  <span class=n>TestCircle</span><span class=p>.</span><span class=n>cpp</span> <span class=o>-</span><span class=n>lCircle</span> <span class=o>-</span><span class=n>o</span> <span class=n>TestCircle</span><span class=p>.</span><span class=n>exe</span> 
</code></pre></div> 这种方法不需要将<code>.so</code>库拷贝到exe所在文件夹内运行exe。</p> <h3 id=g_1>g++ 命令总结<a class=headerlink href=#g_1 title="Permanent link">&para;</a></h3> <blockquote> <p>查看include path和library path</p> </blockquote> <div class=highlight><pre><span></span><code><span class=n>g</span><span class=o>++</span> <span class=o>-</span><span class=n>E</span> <span class=o>-</span><span class=n>x</span> <span class=n>c</span><span class=o>++</span> <span class=o>-</span> <span class=o>-</span><span class=n>v</span> <span class=o>&lt;</span> <span class=o>/</span><span class=n>dev</span><span class=o>/</span><span class=n>null</span>
</code></pre></div> <blockquote> <p>指定include path</p> </blockquote> <div class=highlight><pre><span></span><code><span class=n>g</span><span class=o>++</span>  <span class=o>-</span><span class=n>I</span> <span class=err>&#39;</span><span class=nl>d</span><span class=p>:</span><span class=err>\</span><span class=n>mdeng</span><span class=err>\</span><span class=n>WORK</span><span class=err>\</span><span class=n>MyCode</span><span class=err>\</span><span class=n>CodePratices</span><span class=err>\</span><span class=n>workSpaceCppGcc</span><span class=err>\</span><span class=n>ehchua</span><span class=o>-</span><span class=n>cpp</span><span class=err>\</span><span class=n>testIncludePatah</span><span class=err>\&#39;</span>
</code></pre></div> <blockquote> <p>打包静态库 (下面的命令能正常运行的前提是设置好了include path)</p> </blockquote> <div class=highlight><pre><span></span><code><span class=n>g</span><span class=o>++</span>    <span class=o>-</span><span class=n>c</span> <span class=n>Circle</span><span class=p>.</span><span class=n>cpp</span>  <span class=err>#生成</span><span class=p>.</span><span class=n>o文件</span>
<span class=n>ar</span> <span class=o>-</span><span class=n>crv</span> <span class=n>Circle</span><span class=p>.</span><span class=n>a</span> <span class=n>Circle</span><span class=p>.</span><span class=n>o</span>  <span class=err>#</span> <span class=err>打包成静态库</span><span class=p>.</span><span class=n>a</span> 
</code></pre></div> <blockquote> <p>查看exe文件需要的动态库</p> </blockquote> <p><code>ldd hello.exe</code></p> <div class=highlight><pre><span></span><code>      ntdll.dll =&gt; /cygdrive/c/WINDOWS/SYSTEM32/ntdll.dll (0x7ffb4e260000)
        KERNEL32.DLL =&gt; /cygdrive/c/WINDOWS/System32/KERNEL32.DLL (0x7ffb4c440000)
        KERNELBASE.dll =&gt; /cygdrive/c/WINDOWS/System32/KERNELBASE.dll (0x7ffb4a7f0000)
        cygwin1.dll =&gt; /usr/bin/cygwin1.dll (0x180040000)
        cygstdc++-6.dll =&gt; /usr/bin/cygstdc++-6.dll (0x3d6a20000)
        cyggcc_s-seh-1.dll =&gt; /usr/bin/cyggcc_s-seh-1.dll (0x3e6f70000)
</code></pre></div> <h2 id=_12>参考资料<a class=headerlink href=#_12 title="Permanent link">&para;</a></h2> <p><a href=http://www.crifan.com/files/doc/docbook/cygwin_intro/release/html/cygwin_intro.html#what_is_cygwin>Cygwin详解</a></p> </article> </div> </div> </main> <footer class=md-footer> <div class="md-footer-meta md-typeset"> <div class="md-footer-meta__inner md-grid"> <div class=md-footer-copyright> <div class=md-footer-copyright__highlight> Copyright &copy; mdeng li </div> Made with <a href=https://squidfunk.github.io/mkdocs-material/ target=_blank rel=noopener> Material for MkDocs </a> </div> </div> </div> </footer> </div> <div class=md-dialog data-md-component=dialog> <div class="md-dialog__inner md-typeset"></div> </div> <script id=__config type=application/json>{"base": "../../../..", "features": ["navigation.sections", "navigation.tabs"], "translations": {"clipboard.copy": "\u590d\u5236", "clipboard.copied": "\u5df2\u590d\u5236", "search.config.lang": "ja", "search.config.pipeline": "trimmer, stemmer", "search.config.separator": "[\\uff0c\\u3002]+", "search.placeholder": "\u641c\u7d22", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../../../assets/javascripts/workers/search.fe42c31b.min.js", "version": null}</script> <script src=../../../../assets/javascripts/bundle.7353b375.min.js></script> <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML"></script> </body> </html>